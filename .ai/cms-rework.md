# CMS Rework - Changelog

## Problem

Decap CMS was uploading images to the wrong path. When adding a picture to e.g. the Retrato gallery, the file ended up at `src/content/gallery-orders/src/assets/retrato/...` instead of `src/assets/retrato/...`. This happened because `media_folder` in the CMS config used relative paths, which Decap resolves relative to the YAML file's location, not the repo root.

## What changed

### `public/admin/config.yml`
- All `media_folder` values now use **absolute paths** (prefixed with `/`) so uploads land in the correct directory.
- Added a **Cover** image field to each gallery. This lets you pick a homepage cover image per gallery directly from the CMS.

### `src/content/gallery-orders/*.yml`
- Added a `cover` field (initially empty) to all four YAML files: `retrato.yml`, `naturaleza.yml`, `fotoproducto.yml`, `bya.yml`.

### `src/data/gallery-order.ts`
- Added `cover` to the `OrderConfig` type.
- Added `getCoverPath(galleryName)` export -- reads the cover path from the gallery's YAML config.

### `src/data/Covers.ts`
- No longer hardcodes static imports for cover images.
- Dynamically resolves covers: first checks the YAML config, then falls back to a file named `<gallery>.<ext>` in `src/assets/covers/`.
- Gallery metadata (title, subtitle, path) is still defined here.

### `src/data/Images.ts`
- Image globs now accept `.png`, `.jpg`, `.jpeg`, `.webp`, `.avif` (previously only `.png`).
- Filename parsing uses a generic regex instead of hardcoded `.png` replacement.
- Image map keys are now full filenames (with extension) so ordering works across formats.

### `src/assets/`
- All gallery images deleted (retrato, naturaleza, fotoproducto, bya/a, bya/b).
- `.gitkeep` files added to preserve empty folder structure.
- Cover images and SVGs left untouched.

### `.gitignore`
- Added `public/assets/` since it's a build-time artifact generated by `scripts/sync-public-assets.mjs`.

## CMS workflow after this change

**For Retrato, Naturaleza, Fotoproducto:**
1. Open the gallery in the CMS admin panel.
2. Optionally pick/upload a **Cover** image (shown on the homepage).
3. Add images to the **Order** list -- each entry has an image upload widget pointing to the correct folder.

**For Antes y Despues (bya):**
1. Open "Antes y Despues" in the CMS.
2. Optionally pick/upload a **Cover**.
3. Add **Pairs** -- each pair has a **Before** and **After** image field (uploaded simultaneously), plus an optional alt text.
